@startuml newContractSeq

title Proposed New Contracts Sequence

actor User as user
participant API as api
participant BetResource as br
participant ResolverResource as rr
participant PayoutResource as pr

user -> api : create bet
api -> pr : create payout
pr --> api : bet result token
api -> br : create bet\n(with token)
br --> api : resolution\nresult token
api -> rr : create resolver (with token)
api -> br : get bet\ntoken
br --> api : bet token
api -> rr : get vote token
rr --> api : vote token
api -> pr : get payout token
pr --> api : payout token
api --> user : tokens
user -> br : place bet (with token)
br -> br : capture bet
br -> pr : send money
user -> rr : vote to resolve (with token)
user -> api : vote event
api -> rr : check resolved
rr -> rr : determine result
rr --> api : return result token if resolved
api -> br : send result\ntoken
br -> br : determine winners
br --> api : return bet\nresult token
api -> pr : send bet result token
pr -> pr : determine payout
user -> br : see result
user -> pr : retrieve payout (with token)

@enduml
