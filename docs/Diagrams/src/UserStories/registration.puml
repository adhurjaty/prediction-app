@startuml Registration Sequence

title Registration Sequence

actor User as user
participant "User Flow Storage" as storage
participant UI as ui
database "Local Store" as localstore
participant "API Backend" as api
database Database as db
participant "OAuth Provider" as oauth
participant Flow as flow

user -> ui : Click register 

group OAuth
    ui -> api : Create user endpoint
    api -> oauth : Register user
    oauth -> api : Return user info
    api -> db : Insert user
    api -> ui : Report oauth success/failure
end

group Flow
    ui --> user : prompt for Flow wallet info
    alt user has wallet
        user -> ui : enter wallet info
    else
        user -> ui : click setup flow button
        ui -> ui : redirect to flow instructions
        user -> ui : enter wallet info
    end

    ui -> api : update user with wallet address
    api -> db : update user
    ui -> flow : create Delphai user
    flow --> storage : save user resource
end

ui --> user : show registration complete

@enduml